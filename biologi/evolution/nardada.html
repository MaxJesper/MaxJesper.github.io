<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>N√§r d√• d√•? ‚Äì Evolution, Genetik & Genteknik</title>
  <style>
    body { font-family: Arial, sans-serif; background:#79cee3; margin:0; padding:0; }
    .topbar { max-width: 980px; margin: 14px auto 0; padding: 0 12px; }
    .subject-btn{
      display:inline-block; padding:8px 12px; background:#fff; border-radius:6px;
      box-shadow:0 2px 4px rgba(0,0,0,0.08); text-decoration:none; color:#0056b3;
      margin: 6px 0;
    }
    .subject-btn:hover{ text-decoration: underline; }

    #container { max-width: 980px; margin: 14px auto; padding: 0 12px; }
    #card { background:#fff; border-radius:10px; padding:20px; box-shadow:0 4px 10px rgba(0,0,0,0.10); }
    #meta { display:flex; flex-wrap:wrap; gap:10px; justify-content:space-between; align-items:center; margin-bottom:10px; }
    #meta .pill { background:#eef4ff; color:#003a8c; padding:6px 10px; border-radius:999px; font-size:14px; }
    #meta .small { color:#444; font-size:14px; }

    #content { text-align:left; }
    #content h2 { margin: 6px 0 10px; font-size: 20px; }
    #content .intro { font-size:16px; line-height:1.45; color:#222; }
    #content .q { margin-top:14px; font-size:18px; }
    #content .options { margin-top:8px; padding-left: 18px; }
    #content .options li { margin: 6px 0; }
    #content .answerBox {
      margin-top: 12px; padding: 12px 14px; border-radius: 10px;
      background: #f0f7ff; border: 1px solid #cfe3ff;
    }
    #content .answerBox .label { font-weight: bold; color:#003a8c; }
    #content .answerBox .extra { margin-top:8px; color:#1c1c1c; }
    #content .periodList { margin-top: 10px; line-height: 1.7; }
    #content .periodList .hit { font-weight:bold; }
    #content .concept { font-weight: 700; font-style: italic; }

    .controls { margin-top: 12px; display:flex; flex-wrap:wrap; gap:8px; }
    .controls button {
      padding:10px 12px; border:0; border-radius:8px; cursor:pointer;
      box-shadow:0 2px 4px rgba(0,0,0,0.08); background:#fff; font-size:15px;
    }
    .controls button:hover { background:#f3f3f3; }
    .controls .primary { background:#0056b3; color:#fff; }
    .controls .primary:hover { background:#004799; }

    .hint { margin-top: 10px; color:#555; font-size: 14px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>

<body>
  <div class="topbar">
    <a href="index.html" class="subject-btn">‚Üê Tillbaka till Biologi</a>
  </div>

  <div id="container">
    <div id="card">
      <div id="meta">
        <div class="pill" id="subjectPill">N√§r d√• d√•?</div>
        <div class="small" id="statusText">Kort 1/10 ¬∑ Steg 0/4</div>
      </div>

      <div id="content">
        <!-- Dynamiskt inneh√•ll -->
      </div>

      <div class="controls">
        <button onclick="prevCard()">‚¨ÖÔ∏è F√∂reg√•ende kort</button>
        <button onclick="resetStep()">‚Ü©Ô∏è Starta om steg</button>
        <button class="primary" onclick="nextStep()">N√§sta steg ‚ñ∂</button>
        <button onclick="nextCard()">‚û°Ô∏è N√§sta kort</button>
        <button onclick="shuffleDeck()">üîÄ Blanda fr√•gor</button>
      </div>

      <div class="hint">
        Tips: <span class="mono">N√§sta steg</span> visar i ordning: inledning ‚Üí tidsfr√•ga ‚Üí tidssvar ‚Üí begreppsfr√•ga ‚Üí begreppssvar.
      </div>
    </div>
  </div>

<script>
/**
 * Steg:
 * 0 = Inledning
 * 1 = Fr√•ga 1 (N√§r?)
 * 2 = Svar 1
 * 3 = Fr√•ga 2 (A/B/C)
 * 4 = Svar 2
 */

const FANEROZOIKUM_PERIODER = [
  "Kambrium","Ordovicium","Silur","Devon","Karbon","Perm","Trias","Jura","Krita","Paleogen","Neogen","Kvart√§r"
];

// 10 testkort (kan senare flyttas till JSON-fil)
let deck = [
  {
    id: 1,
    subject: "Evolution",
    intro: `N√§r ryggradsdjur b√∂rjade l√§mna vattnet skedde detta inte i ett spr√•ng. Fossil visar former som kombinerar egenskaper fr√•n olika milj√∂er. Ett centralt begrepp h√§r √§r <span class="concept">√∂verg√•ngsform</span>.`,
    q1: {
      type: "period_fanerozoikum",
      question: "Under vilken geologisk period levde Tiktaalik?",
      correct: "Devon",
      interval: "419‚Äì359 miljoner √•r sedan",
      extra: "Devon kallas ibland \"fiskarnas tids√•lder\" och flera viktiga steg i ryggradsdjurens utveckling mot ett liv delvis p√• land sker d√•."
    },
    q2: {
      question: "Vad menas med begreppet √∂verg√•ngsform?",
      options: {
        A: "En organism som √§r p√• v√§g att d√∂ ut",
        B: "En organism som visar egenskaper fr√•n tv√• st√∂rre grupper",
        C: "En art som saknar fossila sl√§ktingar"
      },
      correct: "B",
      explanation: "En √∂verg√•ngsform har drag fr√•n tv√• st√∂rre organismgrupper och hj√§lper oss f√∂rst√• hur evolution√§ra f√∂r√§ndringar kan ske stegvis."
    }
  },
  {
    id: 2,
    subject: "Evolution",
    intro: `Under en relativt kort period i jordens historia √∂kade antalet djurgrupper kraftigt. M√•nga av dagens djurstammar f√•r sina f√∂rsta tydliga fossilsp√•r h√§r.`,
    q1: {
      type: "period_fanerozoikum",
      question: "N√§r intr√§ffade den kambriska explosionen?",
      correct: "Kambrium",
      interval: "541‚Äì485 miljoner √•r sedan",
      extra: "I kambrium blir h√•rda kroppsdelar vanligare i fossil, vilket g√∂r att m√•nga djurgrupper syns tydligt i berglagren."
    },
    q2: {
      question: "Vad menas med evolution√§r radiation?",
      options: {
        A: "N√§r m√•nga arter snabbt utvecklas fr√•n en gemensam stamform",
        B: "N√§r arter sprids geografiskt utan att f√∂r√§ndras",
        C: "N√§r mutationer minskar i en population"
      },
      correct: "A",
      explanation: "Evolution√§r radiation inneb√§r att en stamform ger upphov till m√•nga nya arter p√• relativt kort tid, ofta n√§r nya livsmilj√∂er eller nischer √∂ppnas."
    }
  },
  {
    id: 3,
    subject: "Evolution",
    intro: `N√§r v√§xter b√∂rjade etablera sig p√• land f√∂r√§ndrades ekosystemen i grunden. Det p√•verkade syrehalter, markbildning och skapade nya livsmilj√∂er f√∂r djur.`,
    q1: {
      type: "period_fanerozoikum",
      question: "N√§r b√∂rjade v√§xter etablera sig p√• land?",
      correct: "Silur",
      interval: "444‚Äì419 miljoner √•r sedan",
      extra: "Tidiga landv√§xter beh√∂vde hantera uttorkning och utvecklade bland annat skyddande ytskikt och enklare st√∂djev√§vnad."
    },
    q2: {
      question: "Vad √§r en anpassning (adaptation)?",
      options: {
        A: "En egenskap som uppst√•r av tr√§ning under livet och √§rvs",
        B: "En egenskap som √∂kar √∂verlevnad eller reproduktion i en viss milj√∂",
        C: "En slumpm√§ssig egenskap som alltid √§r neutral"
      },
      correct: "B",
      explanation: "En anpassning √§r en egenskap som ger f√∂rdel i en viss milj√∂ och d√§rf√∂r kan spridas genom naturligt urval."
    }
  },
  {
    id: 4,
    subject: "Evolution",
    intro: `Ett av de mest k√§nda <span class="concept">massutd√∂endena</span> i jordens historia f√∂r√§ndrade livets utveckling drastiskt. Efter√•t tog d√§ggdjur och f√•glar en st√∂rre roll i m√•nga ekosystem.`,
    q1: {
      type: "period_fanerozoikum",
      question: "Under vilken geologisk period intr√§ffade utd√∂endet som tog bort de flesta dinosaurier?",
      correct: "Krita",
      interval: "145‚Äì66 miljoner √•r sedan (slutet vid ca 66 Ma)",
      extra: "H√§ndelsen kopplas ofta till asteroidnedslag och f√∂ljande klimatf√∂r√§ndringar som slog h√•rt mot n√§ringskedjor."
    },
    q2: {
      question: "Vad menas med massutd√∂ende?",
      options: {
        A: "N√§r alla arter d√∂r ut samtidigt",
        B: "N√§r m√•nga arter f√∂rsvinner under kort tid (geologiskt sett)",
        C: "N√§r en art ers√§tts av en annan i ett omr√•de"
      },
      correct: "B",
      explanation: "Massutd√∂ende inneb√§r att en stor andel av jordens arter d√∂r ut under en relativt kort tidsperiod."
    }
  },
  {
    id: 5,
    subject: "M√§nniskans utveckling",
    intro: `M√§nniskan √§r en ung art i jordens historia. Fossil och DNA visar att v√•r art uppstod i Afrika och senare spreds √∂ver v√§rlden. V√•r utveckling handlar b√•de om biologi och kultur.`,
    q1: {
      type: "human_time",
      question: "Ungef√§r n√§r uppstod Homo sapiens?",
      correctText: "ca 300 000 √•r sedan (sen pleistocen)",
      extra: "Tidiga fynd av Homo sapiens √§r kopplade till Afrika och visar en gradvis utveckling av moderna drag."
    },
    q2: {
      question: "Vad skiljer kulturell fr√•n biologisk evolution?",
      options: {
        A: "Kulturell evolution sker genom gener och mutationer",
        B: "Biologisk evolution g√•r alltid snabbare √§n kulturell",
        C: "Kulturell evolution sker genom l√§rande och traditioner"
      },
      correct: "C",
      explanation: "Kulturell evolution bygger p√• information som f√∂rs vidare via l√§rande, spr√•k och traditioner ‚Äì inte via DNA."
    }
  },
  {
    id: 6,
    subject: "M√§nniskans utveckling",
    intro: `Tidiga homininer gick uppr√§tt l√•ngt innan hj√§rnvolymen √∂kade kraftigt. Det visar att g√•ng p√• tv√• ben inte automatiskt betyder ‚Äúmodern m√§nniska‚Äù.`,
    q1: {
      type: "human_time",
      question: "Ungef√§r n√§r levde Australopithecus?",
      correctText: "ca 4‚Äì2 miljoner √•r sedan (pliocen‚Äìtidig pleistocen)",
      extra: "Australopithecus har kopplats till tidig uppr√§tt g√•ng och levde i varierande milj√∂er i Afrika."
    },
    q2: {
      question: "Vad √§r en hominin?",
      options: {
        A: "Alla primater (apor, halvapor och m√§nniskor)",
        B: "Alla d√§ggdjur som kan g√• p√• tv√• ben",
        C: "M√§nniskan och v√•ra utd√∂da sl√§ktingar efter splittringen fr√•n schimpanser"
      },
      correct: "C",
      explanation: "Homininer √§r m√§nniskans gren efter att v√•r utvecklingslinje skiljdes fr√•n schimpansernas utvecklingslinje."
    }
  },
  {
    id: 7,
    subject: "Genetik",
    intro: `Genetik handlar om hur egenskaper √§rvs. P√• 1800-talet visade experiment med √§rtplantor att √§rftlighet f√∂ljer tydliga m√∂nster, √§ven om man d√• inte k√§nde till DNA.`,
    q1: {
      type: "year",
      question: "Vilket √•r publicerade Gregor Mendel sina resultat om √§rftlighet?",
      correctYear: 1866,
      extra: "Mendels arbete fick f√∂rst senare genomslag, n√§r det ‚Äú√•teruppt√§cktes‚Äù kring √•r 1900."
    },
    q2: {
      question: "Vad beskriver Mendels lagar?",
      options: {
        A: "Hur arter f√∂r√§ndras √∂ver tid genom naturligt urval",
        B: "Hur egenskaper √§rvs mellan generationer via alleler",
        C: "Hur DNA:s dubbelhelix √§r uppbyggd"
      },
      correct: "B",
      explanation: "Mendels lagar handlar om hur alleler f√∂rdelas till k√∂nsceller och hur de kombineras i avkomman."
    }
  },
  {
    id: 8,
    subject: "Genetik",
    intro: `F√∂rst√•elsen av DNA:s struktur blev avg√∂rande f√∂r modern biologi. N√§r man f√∂rstod dubbelhelixen blev det tydligare hur genetisk information kan kopieras och √∂verf√∂ras.`,
    q1: {
      type: "year",
      question: "Vilket √•r publicerades modellen f√∂r DNA:s dubbelhelix?",
      correctYear: 1953,
      extra: "Uppt√§ckten kopplas ofta till Watson & Crick, men Rosalind Franklins r√∂ntgendiffraktion var mycket viktig f√∂r pusslet."
    },
    q2: {
      question: "Vad menas med begreppet genotyp?",
      options: {
        A: "En individs genetiska upps√§ttning (vilka alleler den har)",
        B: "En individs utseende och m√§tbara egenskaper",
        C: "Milj√∂p√•verkan som f√∂r√§ndrar genuttrycket"
      },
      correct: "A",
      explanation: "Genotyp beskriver vilka alleler en individ har. Fenotyp √§r hur egenskaperna faktiskt uttrycks."
    }
  },
  {
    id: 9,
    subject: "Genteknik",
    intro: `I molekyl√§rbiologi beh√∂ver man ofta kopiera en liten DNA-m√§ngd till stora m√§ngder f√∂r att kunna analysera den. D√§rf√∂r blev PCR en revolutionerande metod.`,
    q1: {
      type: "year",
      question: "Vilket √•r utvecklades PCR-tekniken?",
      correctYear: 1983,
      extra: "PCR anv√§nds bland annat i diagnostik, forskning och kriminalteknik n√§r man beh√∂ver f√∂rst√§rka DNA."
    },
    q2: {
      question: "Vad anv√§nds PCR fr√§mst till?",
      options: {
        A: "Att klippa DNA p√• specifika st√§llen",
        B: "Att kopiera (amplifiera) DNA",
        C: "Att √∂vers√§tta RNA till protein"
      },
      correct: "B",
      explanation: "PCR (polymerase chain reaction) g√∂r m√•nga kopior av ett DNA-avsnitt s√• att det g√•r att analysera."
    }
  },
  {
    id: 10,
    subject: "Genteknik",
    intro: `CRISPR-Cas9 √§r ett exempel p√• modern genredigering. Metoden bygger p√• ett bakterief√∂rsvar d√§r ett protein kan klippa DNA p√• ett st√§lle som matchar en styrsekvens.`,
    q1: {
      type: "year",
      question: "Vilket √•r presenterades CRISPR-Cas9 som genredigeringsmetod?",
      correctYear: 2012,
      extra: "CRISPR anv√§nds f√∂r att √§ndra gener i laboratoriet och har stor betydelse f√∂r forskning och medicinska till√§mpningar."
    },
    q2: {
      question: "Vad g√∂r CRISPR-Cas9?",
      options: {
        A: "F√∂rhindrar mutationer i alla celler",
        B: "L√§ser av DNA-sekvenser utan att p√•verka dem",
        C: "Klipper DNA p√• specifika platser (styrt av en guide-sekvens)"
      },
      correct: "C",
      explanation: "Cas9 fungerar som en ‚Äúmolekyl√§r sax‚Äù som klipper DNA p√• en plats som matchar guide-sekvensen."
    }
  }
];

let idx = 0;
let step = 0; // 0..4

function esc(s){ return String(s).replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

function render() {
  const card = deck[idx];
  const subjectPill = document.getElementById("subjectPill");
  const statusText = document.getElementById("statusText");
  const content = document.getElementById("content");

  subjectPill.textContent = card.subject;
  statusText.textContent = `Kort ${idx+1}/${deck.length} ¬∑ Steg ${step}/4`;

  let html = `<h2>${esc(card.subject)} ‚Äì kort ${card.id}</h2>`;

  if (step === 0) {
    html += `<div class="intro">${card.intro}</div>`;
  }

  if (step === 1) {
    html += `<div class="intro">${card.intro}</div>`;
    html += `<div class="q"><strong>Fr√•ga 1 ‚Äì N√§r?</strong><br>${esc(card.q1.question)}</div>`;
  }

  if (step === 2) {
    html += `<div class="intro">${card.intro}</div>`;
    html += `<div class="q"><strong>Fr√•ga 1 ‚Äì N√§r?</strong><br>${esc(card.q1.question)}</div>`;
    html += renderAnswer1(card.q1);
  }

  if (step === 3) {
    html += `<div class="intro">${card.intro}</div>`;
    html += `<div class="q"><strong>Fr√•ga 1 ‚Äì N√§r?</strong><br>${esc(card.q1.question)}</div>`;
    html += renderAnswer1(card.q1);
    html += renderQuestion2(card.q2);
  }

  if (step === 4) {
    html += `<div class="intro">${card.intro}</div>`;
    html += `<div class="q"><strong>Fr√•ga 1 ‚Äì N√§r?</strong><br>${esc(card.q1.question)}</div>`;
    html += renderAnswer1(card.q1);
    html += renderQuestion2(card.q2);
    html += renderAnswer2(card.q2);
  }

  content.innerHTML = html;
}

function renderAnswer1(q1) {
  let box = `<div class="answerBox"><div class="label">Svar 1</div>`;

  if (q1.type === "period_fanerozoikum") {
    const list = FANEROZOIKUM_PERIODER.map(p => {
      if (p === q1.correct) return `<span class="hit">${esc(p)} (${esc(q1.interval)})</span>`;
      return esc(p);
    }).join(" ¬∑ ");
    box += `<div class="periodList">${list}</div>`;
    if (q1.extra) box += `<div class="extra">${esc(q1.extra)}</div>`;
  } else if (q1.type === "year") {
    box += `<div class="periodList"><span class="hit">${esc(q1.correctYear)}</span></div>`;
    if (q1.extra) box += `<div class="extra">${esc(q1.extra)}</div>`;
  } else if (q1.type === "human_time") {
    box += `<div class="periodList"><span class="hit">${esc(q1.correctText)}</span></div>`;
    if (q1.extra) box += `<div class="extra">${esc(q1.extra)}</div>`;
  } else {
    box += `<div class="periodList"><span class="hit">[Ok√§nt format]</span></div>`;
  }

  box += `</div>`;
  return box;
}

function renderQuestion2(q2) {
  return `
    <div class="q"><strong>Fr√•ga 2 ‚Äì Begrepp (A‚ÄìC)</strong><br>${esc(q2.question)}</div>
    <ol class="options" type="A">
      <li>${esc(q2.options.A)}</li>
      <li>${esc(q2.options.B)}</li>
      <li>${esc(q2.options.C)}</li>
    </ol>
  `;
}

function renderAnswer2(q2) {
  return `
    <div class="answerBox">
      <div class="label">Svar 2</div>
      <div class="periodList">R√§tt alternativ: <span class="hit">${esc(q2.correct)}</span></div>
      <div class="extra">${esc(q2.explanation)}</div>
    </div>
  `;
}

function nextStep() {
  step = Math.min(4, step + 1);
  render();
}

function resetStep() {
  step = 0;
  render();
}

function nextCard() {
  idx = (idx + 1) % deck.length;
  step = 0;
  render();
}

function prevCard() {
  idx = (idx - 1 + deck.length) % deck.length;
  step = 0;
  render();
}

function shuffleDeck() {
  // Fisher‚ÄìYates
  for (let i = deck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
  idx = 0;
  step = 0;
  render();
}

// Start
render();
</script>
</body>
</html>

